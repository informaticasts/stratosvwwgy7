<!doctype html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
        <script src="https://unpkg.com/aframe-look-at-component@0.8.0/dist/aframe-look-at-component.min.js"></script>
        <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js"></script>
    </head>

    <body style="margin: 0; overflow: hidden;">
        <a-scene
            embedded
            loading-screen="enabled: false;"
            arjs="sourceType: webcam; debugUIEnabled: false;"
        >
                <a-image
                    src="assets/asset.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 17.064322676903164; longitude: -96.72418599550518;"
                ></a-image>
                <a-image
                    src="assets/asset.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 17.064348318176023; longitude: -96.72420074764256;"
                ></a-image>
                <a-image
                    src="assets/asset.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 17.064327805160172; longitude: -96.72421013537344;"
                ></a-image>
                <a-image
                    src="assets/asset.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 17.064318830715028; longitude: -96.72418063107635;"
                ></a-image>
                <a-image
                    src="assets/asset.png"
                    look-at="[gps-camera]"
                    scale="1 1 1"
                    gps-entity-place="latitude: 17.064326523096618; longitude: -96.7241658789278;"
                ></a-image>

            <a-camera gps-camera rotation-reader></a-camera>
        </a-scene>
        <canvas id="canvas" style="display: none;"></canvas>
        <p id="estado"></p>
        <div id="cont-boton">
            <button id="boton">Tomar foto</button>
        </div>
        <style>
            #cont-boton {
                position: absolute;
                width: 100%;
                height: 100%;
                left: 0;
                top: 0;
                text-align: center;
            }
            #boton {
                padding: 10px 10px;
                border-radius: 1.5em;
                margin-top: 5px;
            }
        </style>
    </body>
    <script>
        
        setTimeout(function () {
            // body...
            var $video = document.getElementById("arjs-video");
            var $canvas = document.getElementById("canvas");
            var $boton = document.getElementById("boton");
            var $estado = document.getElementById("estado");

            $boton.addEventListener("click", function() {

            $video.pause();
     
                //Obtener contexto del canvas y dibujar sobre él
                let contexto = $canvas.getContext("2d");
                $canvas.width = $video.videoWidth;
                $canvas.height = $video.videoHeight;
                contexto.drawImage($video, 0, 0, $canvas.width, $canvas.height);

                let foto = $canvas.toDataURL(); //Esta es la foto, en base 64

                let enlace = document.createElement('a'); // Crear un <a>
                enlace.download = "foto_parzibyte.me.png";
                enlace.href = foto;
                enlace.click();
                //Reanudar reproducción
                $video.play();

            })
                

        }, 5000)

        
       
    </script>
</html>
